FIXME: when applying modes the handler changes the object, should return new object.